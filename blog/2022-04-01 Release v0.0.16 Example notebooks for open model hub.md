---
title: "Release 0.0.16: Example notebooks for the open model hub"
description: "Several new example notebooks that help you get started with the open model hub to analyze and model data, e.g. to quickly cluster your users, explore your conversion, and much more. We’ve also released the Objectiv libraries to PyPI."
slug: release-0.0.16-example-notebooks-for-open-model-hub/
tags: [releases]
image: /img/open-graph/og-example-notebooks-model-hub.png
authors: ivarpruijn
---

<head>
  <meta property="og:title" content="Release 0.0.16: Example notebooks for the open model hub" />
</head>

import BlogImage from '@site/src/components/blog-image'

*With this release we've added several example notebooks that help you get started with the 
[open model hub](https://objectiv.io/docs/modeling/) to analyze and model data. We've also released the 
Objectiv libraries to [PyPI](https://pypi.org/user/objectiv/).*

<!--truncate-->

[models]: https://objectiv.io/docs/modeling/models/
[duration]: https://objectiv.io/docs/modeling/modelhub_api_reference/modelhub.Aggregate.session_duration
[aggregation]: https://objectiv.io/docs/modeling/models_aggregation
[new_user]: https://objectiv.io/docs/modeling/modelhub_api_reference/modelhub.Map.is_new_user
[head]: https://objectiv.io/docs/modeling/Series/bach.Series.head/#bach-series-head
[to_pandas]: https://objectiv.io/docs/modeling/Series/bach.Series.to_pandas
[bach]: https://objectiv.io/docs/modeling/bach
[examples]: https://objectiv.io/docs/modeling/example_notebooks
[ex_product_analytics]: https://objectiv.io/docs/modeling/product_analytics
[ex_taxonomy]: https://objectiv.io/docs/modeling/open_taxonomy
[ex_features]: https://objectiv.io/docs/modeling/feature_engineering
[ex_ml]: https://objectiv.io/docs/modeling/machine_learning
[quickstart]: https://objectiv.io/docs/home/quickstart-guide
[repo]: https://github.com/objectiv/objectiv-analytics
[display_md]: https://github.com/objectiv/objectiv-analytics/blob/b796acd70211db1436eaac8e9120f09c2a7f9d43/bach/bach/display_formats.py

# What is the open model hub?
It's a growing collection of [open-source, free to use data models][models] that you can take, combine, and 
run for a wide range of typical product analytics use cases, from your notebook. 

It enables you to quickly cluster your users, explore your conversion, report on retention, and much more.

**An example of a very common model**: calculating *average session duration*. In the model hub, this is an 
[aggregation][duration] model that is called with [`model_hub.aggregate.session_duration()`][duration]. In 
the example below, we've used this model, and also added filtering on new users only, using a 
[mapping](https://objectiv.io/docs/modeling/models_mapping) model: [`modelhub.map.is_new_user()`][new_user].

<BlogImage 
  url='img/blog/releases/0.0.16-session_duration.png' 
  caption="Avg. daily session duration for new users in a notebook, with the model hub" />

With [`.head()`][head] you can immediately query the data to show the results, and with 
[`.to_pandas()`][to_pandas] use all results as a pandas object in python.

# Bach: the modeling library
The open model hub is powered by **[Bach][bach]**: Objectiv's data modeling library. With Bach, you can fully 
compose models with familiar Pandas-like dataframe operations. It uses an SQL abstraction layer that enables 
models to run on the full dataset, and can export to SQL with a single command. 

<BlogImage url='img/value-pandas-like-operations-on-full-dataset.svg' />

See for instance below for the underlying SQL query snippet generated by Bach for the 
[`session_duration()`][duration] model, by calling [`display_sql_as_markdown(avg_duration)`][display_md]:

```sql
[...several SELECTs]
"merge_sql___fc8b4ee691633be72d66ebe9996ee5a0" as (
            select COALESCE("l"."event_id", "r"."event_id") as "event_id", "l"."day" as "day", "l"."moment" as "moment", "l"."user_id" as "user_id", "l"."global_contexts" as "global_contexts", "l"."location_stack" as "location_stack", "l"."event_type" as "event_type", "l"."stack_event_types" as "stack_event_types", "l"."session_id" as "session_id", "l"."session_hit_number" as "session_hit_number", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"ApplicationContext"}') ->> 'id' as "application", (
                select array_to_string(
                    array_agg(
                        replace(
                            regexp_replace(value ->> '_type', '([a-z])([A-Z])', '\1 \2', 'g'),
                        ' Context', '') || ': ' || (value ->> 'id')
                    ),
                ' => ')
                from jsonb_array_elements("l"."location_stack") with ordinality
                where ordinality = jsonb_array_length("l"."location_stack")) || case
                    when jsonb_array_length("l"."location_stack") > 1
                        then ' located at ' || (select array_to_string(
                    array_agg(
                        replace(
                            regexp_replace(value ->> '_type', '([a-z])([A-Z])', '\1 \2', 'g'),
                        ' Context', '') || ': ' || (value ->> 'id')
                    ),
                ' => ')
                from jsonb_array_elements("l"."location_stack") with ordinality
                where ordinality < jsonb_array_length("l"."location_stack")
                ) else '' end as "feature_nice_name", 
        jsonb_path_query_first("l"."location_stack",
        '$[*] ? (@._type == $type)',
        '{"type":"RootLocationContext"}') ->> 'id' as "root_location", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"HttpContext"}') ->> 'referrer' as "referrer", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"MarketingContext"}') ->> 'source' as "utm_source", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"MarketingContext"}') ->> 'medium' as "utm_medium", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"MarketingContext"}') ->> 'campaign' as "utm_campaign", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"MarketingContext"}') ->> 'content' as "utm_content", 
        jsonb_path_query_first("l"."global_contexts",
        '$[*] ? (@._type == $type)',
        '{"type":"MarketingContext"}') ->> 'term' as "utm_term", "r"."is_new_user" as "is_new_user"
            from "SessionizedData___d0817aa5aa7272ea5e29ec0de18d72e9" as l left
            join "manual_materialize___6c959c61ca55b600c194d6e1d9294de0" as r on ("l"."event_id" = "r"."event_id")
            ),
"manual_materialize___e5dc9e44c751598ce2bc3749165396f1" as (select "event_id" as "event_id", (min("session_id") over (partition by to_char("moment", 'YYYY-MM-DD'), "user_id"  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) = min("session_id") over (partition by "user_id"  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) as "is_new_user" 
from "merge_sql___fc8b4ee691633be72d66ebe9996ee5a0" 
 
 
 
 
 
),
"merge_sql___f9a2cfd81c399ebef9b3e9c43f5b2def" as (
            select COALESCE("l"."event_id", "r"."event_id") as "event_id", "l"."day" as "day", "l"."moment" as "moment", "l"."user_id" as "user_id", "l"."global_contexts" as "global_contexts", "l"."location_stack" as "location_stack", "l"."event_type" as "event_type", "l"."stack_event_types" as "stack_event_types", "l"."session_id" as "session_id", "l"."session_hit_number" as "session_hit_number", "l"."application" as "application", "l"."feature_nice_name" as "feature_nice_name", "l"."root_location" as "root_location", "l"."referrer" as "referrer", "l"."utm_source" as "utm_source", "l"."utm_medium" as "utm_medium", "l"."utm_campaign" as "utm_campaign", "l"."utm_content" as "utm_content", "l"."utm_term" as "utm_term", "l"."is_new_user" as "is_new_user", "r"."is_new_user" as "is_new_user__remove"
            from "merge_sql___fc8b4ee691633be72d66ebe9996ee5a0" as l left
            join "manual_materialize___e5dc9e44c751598ce2bc3749165396f1" as r on ("l"."event_id" = "r"."event_id")
            ),
"manual_materialize___208ec4119965cc009c3ac8abf548b570" as (select "event_id" as "event_id", (min("session_id") over (partition by to_char("moment", 'YYYY-MM-DD'), "user_id"  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) = min("session_id") over (partition by "user_id"  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) as "is_new_user" 
from "merge_sql___f9a2cfd81c399ebef9b3e9c43f5b2def" 
 
 
 
 
 
),
"merge_sql___f3291d78bc28263033e447016de5052b" as (
            select COALESCE("l"."event_id", "r"."event_id") as "event_id", "l"."day" as "day", "l"."moment" as "moment", "l"."user_id" as "user_id", "l"."global_contexts" as "global_contexts", "l"."location_stack" as "location_stack", "l"."event_type" as "event_type", "l"."stack_event_types" as "stack_event_types", "l"."session_id" as "session_id", "l"."session_hit_number" as "session_hit_number", "l"."application" as "application", "l"."feature_nice_name" as "feature_nice_name", "l"."root_location" as "root_location", "l"."referrer" as "referrer", "l"."utm_source" as "utm_source", "l"."utm_medium" as "utm_medium", "l"."utm_campaign" as "utm_campaign", "l"."utm_content" as "utm_content", "l"."utm_term" as "utm_term", "l"."is_new_user__remove" as "is_new_user", "r"."is_new_user" as "is_new_user__remove"
            from "merge_sql___f9a2cfd81c399ebef9b3e9c43f5b2def" as l left
            join "manual_materialize___208ec4119965cc009c3ac8abf548b570" as r on ("l"."event_id" = "r"."event_id")
            ),
"getitem_where_boolean___42ef48db14f4e03bdac4ba717cf7ee3c" as (select "event_id" as "event_id", "day" as "day", "moment" as "moment", "user_id" as "user_id", "global_contexts" as "global_contexts", "location_stack" as "location_stack", "event_type" as "event_type", "stack_event_types" as "stack_event_types", "session_id" as "session_id", "session_hit_number" as "session_hit_number", "application" as "application", "feature_nice_name" as "feature_nice_name", "root_location" as "root_location", "referrer" as "referrer", "utm_source" as "utm_source", "utm_medium" as "utm_medium", "utm_campaign" as "utm_campaign", "utm_content" as "utm_content", "utm_term" as "utm_term", "is_new_user__remove" as "is_new_user" 
from "merge_sql___f3291d78bc28263033e447016de5052b" 
where "is_new_user__remove" 
 
 
 
 
),
"getitem_having_boolean___ddcf158ce4b9ea9d4318d5f57eb20bb5" as (select to_char("moment", 'YYYY-MM-DD') as "time_aggregation", "session_id" as "_session_id", min("moment") as "moment_min", max("moment") as "moment_max", ((max("moment")) - (min("moment"))) as "session_duration" 
from "getitem_where_boolean___42ef48db14f4e03bdac4ba717cf7ee3c" 
 
group by (to_char("moment", 'YYYY-MM-DD'), "session_id") 
having (((max("moment")) - (min("moment"))) > '0') 
 
 
)
select "time_aggregation" as "time_aggregation", avg("session_duration") as "session_duration" 
from "getitem_having_boolean___ddcf158ce4b9ea9d4318d5f57eb20bb5" 
 
group by ("time_aggregation") 
```

# Example notebooks
We now have [several Jupyter notebook examples][examples] in our GitHub repository to get you started on the 
open model hub & Bach. For instance:
* How to use the open model hub for basic **[product analytics][ex_product_analytics]**.
* How to use Bach with **[rich open analytics taxonomy data][ex_taxonomy]**.
* How to use Bach for **[feature engineering][ex_features]**.
* How to use Bach + sklearn for **[Machine Learning directly on the raw data in your SQL database][ex_ml]**, 
such as user clustering.


<BlogImage url='/img/open-graph/og-example-notebooks-model-hub.png'
  size="medium" />


# How to use it
For a quick-start, there’s a [Docker-based demo][quickstart] that runs the full Objectiv pipeline on your 
local machine, including a Jupyter notebook environment with all the new example notebooks. 

If you’re ready to use the open model hub and/or Bach in your notebooks, head on over to our 
[Modeling documentation][models]. The packages you need can now be installed with `pip`:

```bash
pip install objectiv-modelhub
pip install objectiv-bach
```

# More models are coming
We’re continuously expanding the available set of models. One of the models that we’re working on right now 
is **Impact Scores**: scoring the impact of user interactions on your product goals, such as conversion.

To get updates on new models, star our [repo][repo].

Enjoy the new example notebooks!
